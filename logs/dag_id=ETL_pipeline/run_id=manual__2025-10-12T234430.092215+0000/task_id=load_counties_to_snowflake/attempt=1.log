[2025-10-12T23:44:32.362+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509
[2025-10-12T23:44:32.363+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake'
[2025-10-12T23:44:32.404+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509
[2025-10-12T23:44:32.405+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake'
[2025-10-12T23:44:32.453+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ETL_pipeline.load_counties_to_snowflake manual__2025-10-12T23:44:30.092215+00:00 [queued]>
[2025-10-12T23:44:32.460+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ETL_pipeline.load_counties_to_snowflake manual__2025-10-12T23:44:30.092215+00:00 [queued]>
[2025-10-12T23:44:32.461+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 3
[2025-10-12T23:44:32.472+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): load_counties_to_snowflake> on 2025-10-12 23:44:30.092215+00:00
[2025-10-12T23:44:32.481+0000] {standard_task_runner.py:57} INFO - Started process 11860 to run task
[2025-10-12T23:44:32.487+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'ETL_pipeline', 'load_counties_to_snowflake', 'manual__2025-10-12T23:44:30.092215+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/ETL_pipeline.py', '--cfg-path', '/tmp/tmpafyfyi96']
[2025-10-12T23:44:32.493+0000] {standard_task_runner.py:85} INFO - Job 26: Subtask load_counties_to_snowflake
[2025-10-12T23:44:32.543+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509
[2025-10-12T23:44:32.544+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-12T23:44:30.092215+00:00/task_id=load_counties_to_snowflake'
[2025-10-12T23:44:32.546+0000] {task_command.py:415} INFO - Running <TaskInstance: ETL_pipeline.load_counties_to_snowflake manual__2025-10-12T23:44:30.092215+00:00 [running]> on host f22a895b55de
[2025-10-12T23:44:32.633+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='bech' AIRFLOW_CTX_DAG_ID='ETL_pipeline' AIRFLOW_CTX_TASK_ID='load_counties_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2025-10-12T23:44:30.092215+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-12T23:44:30.092215+00:00'
[2025-10-12T23:44:32.635+0000] {bronze_counties_layer.py:255} INFO - Starting bronze layer data ingestion for US Counties Centroids...
[2025-10-12T23:44:32.636+0000] {bronze_counties_layer.py:47} INFO - Reading counties centroids data from: /opt/***/input/US_Counties_Centroids.csv
[2025-10-12T23:44:32.659+0000] {bronze_counties_layer.py:57} INFO - Successfully loaded CSV file. Shape: (3143, 15)
[2025-10-12T23:44:32.660+0000] {bronze_counties_layer.py:58} INFO - Columns: ['X', 'Y', 'OBJECTID_1', 'NAME', 'STATE', 'STATE_FIPS_CD', 'COUNTY_FIPS_CD', 'FIPS_CD', 'POPULATION', 'POP_SQMI', 'SQMI', 'DHCS_CNTY_CD', 'OBJECTID', 'LATITUDE', 'LONGITUDE']
[2025-10-12T23:44:32.675+0000] {bronze_counties_layer.py:59} INFO - First few rows:
           X          Y  OBJECTID_1  ... OBJECTID   LATITUDE  LONGITUDE
0 -86.641296  32.539426           1  ...        1  32.539426 -86.641296
1 -87.724796  30.743120           2  ...        2  30.743120 -87.724796
2 -85.392378  31.877343           3  ...        3  31.877343 -85.392378
3 -87.127522  33.000207           4  ...        4  33.000207 -87.127522
4 -86.567047  33.983247           5  ...        5  33.983247 -86.567047

[5 rows x 15 columns]
[2025-10-12T23:44:32.676+0000] {bronze_counties_layer.py:69} INFO - Creating Snowflake connection...
[2025-10-12T23:44:32.676+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2025-10-12T23:44:32.678+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-10-12T23:44:32.678+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2025-10-12T23:44:33.467+0000] {bronze_counties_layer.py:82} INFO - Snowflake connection established successfully
[2025-10-12T23:44:33.468+0000] {bronze_counties_layer.py:222} INFO - Storing data in Snowflake using COPY command...
[2025-10-12T23:44:33.504+0000] {bronze_counties_layer.py:158} INFO - Uploading CSV file to stage US_Counties_Centroids_STAGE...
[2025-10-12T23:44:33.505+0000] {cursor.py:804} INFO - query: [CREATE STAGE IF NOT EXISTS US_Counties_Centroids_STAGE]
[2025-10-12T23:44:33.658+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:33.659+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-12T23:44:33.660+0000] {cursor.py:804} INFO - query: [PUT file:///tmp/counties_centroids_with_metadata.csv @US_Counties_Centroids_STAG...]
[2025-10-12T23:44:33.794+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:34.405+0000] {cursor.py:804} INFO - query: [LIST @US_Counties_Centroids_STAGE]
[2025-10-12T23:44:34.632+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:34.633+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-12T23:44:34.634+0000] {bronze_counties_layer.py:171} INFO - Files in stage: [('us_counties_centroids_stage/counties_centroids_with_metadata.csv.gz', 173296, '4c295c43eb883b24d60733190fac8928', 'Sun, 12 Oct 2025 23:44:35 GMT')]
[2025-10-12T23:44:34.634+0000] {bronze_counties_layer.py:115} INFO - Creating table US_Counties_Centroids if it doesn't exist...
[2025-10-12T23:44:34.635+0000] {cursor.py:804} INFO - query: [CREATE TABLE IF NOT EXISTS US_Counties_Centroids ( X FLOAT, Y FLOAT, OBJECTID_1 ...]
[2025-10-12T23:44:34.761+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:34.762+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-12T23:44:34.763+0000] {bronze_counties_layer.py:143} INFO - Table US_Counties_Centroids created or already exists
[2025-10-12T23:44:34.764+0000] {bronze_counties_layer.py:186} INFO - Copying data from stage to table US_Counties_Centroids...
[2025-10-12T23:44:34.765+0000] {cursor.py:804} INFO - query: [COPY INTO US_Counties_Centroids FROM @US_Counties_Centroids_STAGE FILE_FORMAT=(T...]
[2025-10-12T23:44:36.037+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:36.037+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-12T23:44:36.038+0000] {bronze_counties_layer.py:200} INFO - COPY operation result: ('us_counties_centroids_stage/counties_centroids_with_metadata.csv.gz', 'LOAD_FAILED', 3143, 0, 3143, 3143, 'Number of columns in file (18) does not match that of the corresponding table (1), use file format option error_on_column_count_mismatch=false to ignore this error', 3, 1, '"US_COUNTIES_CENTROIDS"[18]')
[2025-10-12T23:44:36.039+0000] {cursor.py:804} INFO - query: [SELECT COUNT(*) FROM US_Counties_Centroids]
[2025-10-12T23:44:36.198+0000] {cursor.py:817} INFO - query execution done
[2025-10-12T23:44:36.199+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-12T23:44:36.201+0000] {bronze_counties_layer.py:205} INFO - Total rows in US_Counties_Centroids: 0
[2025-10-12T23:44:36.202+0000] {logging_mixin.py:151} INFO - Data loaded into US_Counties_Centroids
[2025-10-12T23:44:36.203+0000] {bronze_counties_layer.py:247} INFO - âœ… Successfully stored data in US_Counties_Centroids
[2025-10-12T23:44:36.203+0000] {bronze_counties_layer.py:269} INFO - ðŸŽ‰ Bronze layer ingestion completed successfully!
[2025-10-12T23:44:36.204+0000] {bronze_counties_layer.py:270} INFO - ðŸ“Š Data shape: (3143, 15)
[2025-10-12T23:44:36.204+0000] {bronze_counties_layer.py:271} INFO - ðŸ’¾ Database: OILGAS_DB
[2025-10-12T23:44:36.204+0000] {bronze_counties_layer.py:272} INFO - ðŸ“‹ Schema: raw
[2025-10-12T23:44:36.204+0000] {bronze_counties_layer.py:273} INFO - ðŸ“‹ Table: US_Counties_Centroids
[2025-10-12T23:44:36.204+0000] {bronze_counties_layer.py:274} INFO - ðŸ“‹ Columns: ['X', 'Y', 'OBJECTID_1', 'NAME', 'STATE', 'STATE_FIPS_CD', 'COUNTY_FIPS_CD', 'FIPS_CD', 'POPULATION', 'POP_SQMI', 'SQMI', 'DHCS_CNTY_CD', 'OBJECTID', 'LATITUDE', 'LONGITUDE']
[2025-10-12T23:44:36.205+0000] {connection.py:640} INFO - closed
[2025-10-12T23:44:36.247+0000] {connection.py:646} INFO - No async queries seem to be running, deleting session
[2025-10-12T23:44:36.302+0000] {bronze_counties_layer.py:283} INFO - Snowflake connection closed
[2025-10-12T23:44:36.303+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-10-12T23:44:36.316+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=ETL_pipeline, task_id=load_counties_to_snowflake, execution_date=20251012T234430, start_date=20251012T234432, end_date=20251012T234436
[2025-10-12T23:44:36.394+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-10-12T23:44:36.413+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
