[2025-10-13T03:49:23.162+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509
[2025-10-13T03:49:23.164+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake'
[2025-10-13T03:49:23.208+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509
[2025-10-13T03:49:23.208+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake'
[2025-10-13T03:49:23.272+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ETL_pipeline.load_earthquake_to_snowflake manual__2025-10-13T03:49:20.505940+00:00 [queued]>
[2025-10-13T03:49:23.281+0000] {taskinstance.py:1157} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ETL_pipeline.load_earthquake_to_snowflake manual__2025-10-13T03:49:20.505940+00:00 [queued]>
[2025-10-13T03:49:23.282+0000] {taskinstance.py:1359} INFO - Starting attempt 1 of 3
[2025-10-13T03:49:23.311+0000] {taskinstance.py:1380} INFO - Executing <Task(PythonOperator): load_earthquake_to_snowflake> on 2025-10-13 03:49:20.505940+00:00
[2025-10-13T03:49:23.324+0000] {standard_task_runner.py:57} INFO - Started process 18549 to run task
[2025-10-13T03:49:23.328+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'ETL_pipeline', 'load_earthquake_to_snowflake', 'manual__2025-10-13T03:49:20.505940+00:00', '--job-id', '43', '--raw', '--subdir', 'DAGS_FOLDER/ETL_pipeline.py', '--cfg-path', '/tmp/tmpfom0t8__']
[2025-10-13T03:49:23.332+0000] {standard_task_runner.py:85} INFO - Job 43: Subtask load_earthquake_to_snowflake
[2025-10-13T03:49:23.389+0000] {logging_mixin.py:151} INFO - Changing /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509
[2025-10-13T03:49:23.389+0000] {logging_mixin.py:151} INFO - Failed to change /opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake permission to 509: [Errno 1] Operation not permitted: '/opt/***/logs/dag_id=ETL_pipeline/run_id=manual__2025-10-13T03:49:20.505940+00:00/task_id=load_earthquake_to_snowflake'
[2025-10-13T03:49:23.392+0000] {task_command.py:415} INFO - Running <TaskInstance: ETL_pipeline.load_earthquake_to_snowflake manual__2025-10-13T03:49:20.505940+00:00 [running]> on host f22a895b55de
[2025-10-13T03:49:23.468+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='bech' AIRFLOW_CTX_DAG_ID='ETL_pipeline' AIRFLOW_CTX_TASK_ID='load_earthquake_to_snowflake' AIRFLOW_CTX_EXECUTION_DATE='2025-10-13T03:49:20.505940+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-13T03:49:20.505940+00:00'
[2025-10-13T03:49:23.469+0000] {bronze_earthquake_layer.py:309} INFO - Starting bronze layer data ingestion for USGS Earthquake Data...
[2025-10-13T03:49:23.470+0000] {bronze_earthquake_layer.py:46} INFO - Getting earthquake data from USGS for USA...
[2025-10-13T03:49:27.320+0000] {bronze_earthquake_layer.py:101} INFO - Successfully loaded 18711 earthquake records
[2025-10-13T03:49:27.321+0000] {bronze_earthquake_layer.py:102} INFO - Data shape: (18711, 30)
[2025-10-13T03:49:27.335+0000] {bronze_earthquake_layer.py:112} INFO - Creating Snowflake connection...
[2025-10-13T03:49:27.336+0000] {connection.py:314} INFO - Snowflake Connector for Python Version: 3.1.1, Python Version: 3.8.18, Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.2.5
[2025-10-13T03:49:27.337+0000] {connection.py:1050} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2025-10-13T03:49:27.337+0000] {connection.py:1068} INFO - Setting use_openssl_only mode to False
[2025-10-13T03:49:27.876+0000] {bronze_earthquake_layer.py:125} INFO - Snowflake connection established successfully
[2025-10-13T03:49:27.877+0000] {bronze_earthquake_layer.py:276} INFO - Storing data in Snowflake using COPY command...
[2025-10-13T03:49:28.212+0000] {bronze_earthquake_layer.py:206} INFO - Uploading CSV file to stage bronze_earthquake_raw_STAGE...
[2025-10-13T03:49:28.213+0000] {cursor.py:804} INFO - query: [CREATE STAGE IF NOT EXISTS bronze_earthquake_raw_STAGE]
[2025-10-13T03:49:28.420+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:28.421+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-13T03:49:28.422+0000] {cursor.py:804} INFO - query: [PUT file:///tmp/earthquake_data_with_metadata.csv @bronze_earthquake_raw_STAGE O...]
[2025-10-13T03:49:28.794+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:29.992+0000] {cursor.py:804} INFO - query: [LIST @bronze_earthquake_raw_STAGE]
[2025-10-13T03:49:30.102+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:30.103+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-13T03:49:30.104+0000] {bronze_earthquake_layer.py:219} INFO - Files in stage: [('bronze_earthquake_raw_stage/earthquake_data_with_metadata.csv.gz', 1570496, '46d4817725bc37fb4236a351e139ad08', 'Mon, 13 Oct 2025 03:49:31 GMT')]
[2025-10-13T03:49:30.104+0000] {bronze_earthquake_layer.py:161} INFO - Creating table bronze_earthquake_raw if it doesn't exist...
[2025-10-13T03:49:30.105+0000] {cursor.py:804} INFO - query: [CREATE TABLE IF NOT EXISTS bronze_earthquake_raw ( "id" VARCHAR(500), "magnitude...]
[2025-10-13T03:49:30.290+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:30.291+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-13T03:49:30.291+0000] {bronze_earthquake_layer.py:191} INFO - Table bronze_earthquake_raw created or already exists
[2025-10-13T03:49:30.291+0000] {bronze_earthquake_layer.py:234} INFO - Copying data from stage to table bronze_earthquake_raw...
[2025-10-13T03:49:30.292+0000] {cursor.py:804} INFO - query: [COPY INTO bronze_earthquake_raw FROM @bronze_earthquake_raw_STAGE FILE_FORMAT=( ...]
[2025-10-13T03:49:31.792+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:31.793+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-13T03:49:31.794+0000] {bronze_earthquake_layer.py:254} INFO - COPY operation result: ('bronze_earthquake_raw_stage/earthquake_data_with_metadata.csv.gz', 'LOADED', 18711, 18711, 18711, 0, None, None, None, None)
[2025-10-13T03:49:31.794+0000] {cursor.py:804} INFO - query: [SELECT COUNT(*) FROM bronze_earthquake_raw]
[2025-10-13T03:49:31.965+0000] {cursor.py:817} INFO - query execution done
[2025-10-13T03:49:31.966+0000] {cursor.py:959} INFO - Number of results in first chunk: 1
[2025-10-13T03:49:31.967+0000] {bronze_earthquake_layer.py:259} INFO - Total rows in bronze_earthquake_raw: 18711
[2025-10-13T03:49:31.968+0000] {bronze_earthquake_layer.py:261} INFO - Data loaded into bronze_earthquake_raw
[2025-10-13T03:49:31.970+0000] {bronze_earthquake_layer.py:301} INFO - âœ… Successfully stored earthquake data in bronze_earthquake_raw
[2025-10-13T03:49:31.973+0000] {bronze_earthquake_layer.py:327} INFO - ðŸŽ‰ Bronze layer ingestion completed successfully!
[2025-10-13T03:49:31.974+0000] {bronze_earthquake_layer.py:328} INFO - ðŸ“Š Data shape: (18711, 30)
[2025-10-13T03:49:31.974+0000] {bronze_earthquake_layer.py:329} INFO - ðŸ“ˆ Date range: 2025-07-15 to 2025-10-13
[2025-10-13T03:49:31.974+0000] {bronze_earthquake_layer.py:330} INFO - ðŸŒŽ Region: USA
[2025-10-13T03:49:31.975+0000] {bronze_earthquake_layer.py:331} INFO - ðŸ’¾ Database: OILGAS_DB
[2025-10-13T03:49:31.976+0000] {bronze_earthquake_layer.py:332} INFO - ðŸ“‹ Schema: raw
[2025-10-13T03:49:31.976+0000] {bronze_earthquake_layer.py:333} INFO - ðŸ“‹ Table: bronze_earthquake_raw
[2025-10-13T03:49:31.976+0000] {bronze_earthquake_layer.py:334} INFO - ðŸ“‹ Columns: ['id', 'magnitude', 'place', 'time', 'updated', 'tz', 'url', 'detail', 'felt', 'cdi', 'mmi', 'alert', 'status', 'tsunami', 'sig', 'net', 'code', 'ids', 'sources', 'types', 'nst', 'dmin', 'rms', 'gap', 'magType', 'type', 'title', 'longitude', 'latitude', 'depth']
[2025-10-13T03:49:31.976+0000] {logging_mixin.py:151} INFO - 
âœ… Successfully ingested USGS earthquake data!
[2025-10-13T03:49:31.977+0000] {logging_mixin.py:151} INFO - ðŸ“Š Total earthquakes loaded: 18711
[2025-10-13T03:49:31.977+0000] {logging_mixin.py:151} INFO - ðŸ“… Date range: 2025-07-15 to 2025-10-13
[2025-10-13T03:49:31.978+0000] {logging_mixin.py:151} INFO - ðŸŒŽ Region: USA
[2025-10-13T03:49:31.978+0000] {connection.py:640} INFO - closed
[2025-10-13T03:49:32.020+0000] {connection.py:646} INFO - No async queries seem to be running, deleting session
[2025-10-13T03:49:32.069+0000] {bronze_earthquake_layer.py:348} INFO - Snowflake connection closed
[2025-10-13T03:49:32.077+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-10-13T03:49:32.087+0000] {taskinstance.py:1398} INFO - Marking task as SUCCESS. dag_id=ETL_pipeline, task_id=load_earthquake_to_snowflake, execution_date=20251013T034920, start_date=20251013T034923, end_date=20251013T034932
[2025-10-13T03:49:32.129+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-10-13T03:49:32.142+0000] {taskinstance.py:2776} INFO - 0 downstream tasks scheduled from follow-on schedule check
